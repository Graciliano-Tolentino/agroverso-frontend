<!-- ========================================================================================
ğŸ“ partials/menu-irrigacao.html â€“ Menu Lateral para MÃ³dulo de IrrigaÃ§Ã£o â€¢ Agroverso
ğŸŒ¿ Acesso contextual por perfil, visual regenerativo e navegaÃ§Ã£o Ã©tica
======================================================================================== -->

<nav id="menuPrivado" class="menu-lateral" hidden aria-label="Menu lateral do mÃ³dulo de irrigaÃ§Ã£o">
  <ul class="menu-lista">

    <!-- CabeÃ§alho do menu -->
    <li class="menu-titulo">
      ğŸŒ± IrrigaÃ§Ã£o Inteligente
    </li>

    <!-- Painel Principal (redireciona com base no perfil ativo) -->
    <li>
      <a href="#" onclick="redirecionarDashboard()">ğŸ” Painel Inicial</a>
    </li>

    <!-- Acesso por funÃ§Ã£o -->
    <li class="menu-secao">ğŸ“‚ Funcionalidades</li>

    <!-- Itens disponÃ­veis apenas a determinados perfis -->
    <li data-perfil="administrador gerente">
      <a href="dashboards/irrigacao/admin.html">âš™ï¸ AdministraÃ§Ã£o</a>
    </li>

    <li data-perfil="gerente lider">
      <a href="dashboards/irrigacao/gerente.html">ğŸ“‹ GestÃ£o de Equipe</a>
    </li>

    <li data-perfil="lider tecnico">
      <a href="dashboards/irrigacao/tecnico.html">ğŸ’§ OperaÃ§Ãµes em Campo</a>
    </li>

    <!-- Sair -->
    <li>
      <a href="#" onclick="logout()">ğŸšª Sair</a>
    </li>

  </ul>
</nav>

<script>
  // Redireciona para o dashboard adequado com base no perfil
  function redirecionarDashboard() {
    const perfil = sessionStorage.getItem("usuario_perfil");
    const rotas = {
      administrador: "dashboards/irrigacao/admin.html",
      gerente: "dashboards/irrigacao/gerente.html",
      lider: "dashboards/irrigacao/lider.html",
      tecnico: "dashboards/irrigacao/tecnico.html",
    };
    if (rotas[perfil]) window.location.href = rotas[perfil];
    else window.location.href = "login.html";
  }

  // Aplica controle de visibilidade por perfil
  document.addEventListener("DOMContentLoaded", () => {
    const perfilAtual = sessionStorage.getItem("usuario_perfil");
    document.querySelectorAll("[data-perfil]").forEach((item) => {
      const perfisAutorizados = item.getAttribute("data-perfil").split(" ");
      if (!perfisAutorizados.includes(perfilAtual)) {
        item.style.display = "none";
      }
    });
  });
</script>
